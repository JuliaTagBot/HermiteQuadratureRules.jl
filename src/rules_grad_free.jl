const grad_free_hermite_nodes = (
    (0.0,),
    ( -1.732050807568877193e+00, 0.0, 1.732050807568877193e+00),
    ( -2.861279576057058183e+00, 2.861279576057058183e+00, -1.732050807568877193e+00, 7.410953499945408529e-01, 1.732050807568877193e+00, -4.184956017672732287e+00, 4.184956017672732287e+00, -7.410953499945408529e-01, 0.0),
    (2.596083115049202306e+00, 6.363394494336369611e+00, -6.363394494336369611e+00, -3.205333794499194422e+00, 1.732050807568877193e+00, 5.187016039913656229e+00, -1.230423634027306035e+00, 4.184956017672732287e+00, -1.732050807568877193e+00, -4.184956017672732287e+00, 1.230423634027306035e+00, 3.205333794499194422e+00, -5.187016039913656229e+00, -2.861279576057058183e+00, 2.861279576057058183e+00, 7.410953499945408529e-01, 0.000000000000000000e+00, -2.596083115049202306e+00, -7.410953499945408529e-01),
    (-5.738816857731674048e+00, 7.809096669391978551e+00, -8.661390355138452790e+00, 5.738816857731674048e+00, 8.661390355138452790e+00, -7.809096669391978551e+00, -7.052048695931292244e+00, 7.052048695931292244e+00, -2.208370035755473193e+00, 4.688944733396042786e+00, 2.596083115049202306e+00, 2.208370035755473193e+00, -9.691888484307325413e+00, -5.187016039913656229e+00, 6.363394494336369611e+00, 1.732050807568877193e+00, -4.184956017672732287e+00, 5.187016039913656229e+00, -7.410953499945408529e-01, 9.691888484307325413e+00, -6.363394494336369611e+00, 7.410953499945408529e-01, 4.184956017672732287e+00, -1.732050807568877193e+00, 3.673120807624038697e+00, 0.000000000000000000e+00, 2.861279576057058183e+00, -3.205333794499194422e+00, -4.688944733396042786e+00, -1.230423634027306035e+00, -2.861279576057058183e+00, 1.230423634027306035e+00, 3.035159417196289788e-01, 3.205333794499194422e+00, -2.596083115049202306e+00, -3.035159417196289788e-01, -3.673120807624038697e+00),
    (-1.413301728617947717e+01, -1.091154446366382835e+01, -1.586543512793624977e+01, -2.208370035755473193e+00, -1.266385440024828846e+01, -1.467031519464652867e+01, -1.049797509743559409e+01, -1.741041065963615253e+01, -6.363394494336369611e+00, -1.313446784351190466e+01, -4.519991606227620196e+00, -1.656423516155702913e+01, -1.524314486007864389e+01, -1.874020592699235932e+00, -7.052048695931292244e+00, -7.289858306075302607e+00, -1.176537484480120277e+01, -5.474559779359854161e+00, -6.034481198100183796e+00, -1.133361676429119136e+01, -1.362290117407219192e+01, -3.673120807624038697e+00, -1.732050807568877193e+00, -1.230423634027306035e+00, -6.707072145057108692e+00, -3.205333794499194422e+00, -7.460729234405580890e+00, -1.220821525266299190e+01, -5.738816857731674048e+00, -3.813668067407607332e+00, -4.688944733396042786e+00, -4.184956017672732287e+00, -2.861279576057058183e+00, -2.596083115049202306e+00, -3.588718867304420357e+00, -1.556920948898949275e+00, -5.187016039913656229e+00, -2.570161501011057670e+00, -4.871869590277843720e+00, 1.467031519464652867e+01, 1.362290117407219192e+01, 1.656423516155702913e+01, -9.295854667849322794e+00, 1.313446784351190466e+01, -7.809096669391978551e+00, -8.886347001304686799e+00, 9.041718401396522387e-01, 6.363394494336369611e+00, 3.588718867304420357e+00, -9.691888484307325413e+00, 8.181394510092470540e+00, 1.049797509743559409e+01, -1.009182628500030354e+01, 1.266385440024828846e+01, 1.556920948898949275e+00, 1.413301728617947717e+01, 9.295854667849322794e+00, 7.289858306075302607e+00, 2.861279576057058183e+00, 4.519991606227620196e+00, -7.410953499945408529e-01, 4.184956017672732287e+00, 5.474559779359854161e+00, -8.661390355138452790e+00, 1.524314486007864389e+01, 1.176537484480120277e+01, 8.661390355138452790e+00, 1.133361676429119136e+01, 1.220821525266299190e+01, 8.886347001304686799e+00, 1.741041065963615253e+01, 1.732050807568877193e+00, 7.410953499945408529e-01, 3.813668067407607332e+00, 2.596083115049202306e+00, 8.612155515170002218e+00, 3.673120807624038697e+00, 1.091154446366382835e+01, 5.187016039913656229e+00, 4.871869590277843720e+00, 6.707072145057108692e+00, 7.460729234405580890e+00, 7.809096669391978551e+00, 1.586543512793624977e+01, 2.570161501011057670e+00, 1.874020592699235932e+00, 6.034481198100183796e+00, -3.035159417196289788e-01, -9.041718401396522387e-01, 5.738816857731674048e+00, 9.691888484307325413e+00, 4.688944733396042786e+00, 7.052048695931292244e+00, 6.206215996851309757e-01, -8.181394510092470540e+00, -8.612155515170002218e+00, 3.205333794499194422e+00, 1.009182628500030354e+01, -6.206215996851309757e-01, 3.035159417196289788e-01, 2.208370035755473193e+00, 0.000000000000000000e+00, 1.230423634027306035e+00)
)

const grad_free_hermite_weights = (
    (1.0,),
    (1.666666666666666574e-01, 6.666666666666666297e-01, 1.666666666666666574e-01),
    (7.996325470893532808e-03, 7.996325470893532808e-03, 9.485094850948509737e-02, 2.700743295779378661e-01, 9.485094850948509737e-02, 9.426945755651748365e-05, 9.426945755651748365e-05, 2.700743295779378661e-01, 2.539682539682539542e-01),
    (1.808523425479845181e-02, 8.629684602229885931e-10, 8.629684602229885931e-10, 2.884880436506751140e-03, 6.409605468680758256e-02, 6.094808731468982961e-07, 6.115173012524767471e-02, 6.012336945984782032e-05, 6.409605468680758256e-02, 6.012336945984782032e-05, 6.115173012524767471e-02, 2.884880436506751140e-03, 6.094808731468982961e-07, -6.337224793373735440e-03, -6.337224793373735440e-03, 2.083249916496088816e-01, 3.034671998542058935e-01, 1.808523425479845181e-02, 2.083249916496088816e-01),
    (1.659544880938981831e-08, 1.822427515491293625e-14, 1.877818931437289588e-17, 1.659544880938981831e-08, 1.877818931437289588e-17, 1.822427515491293625e-14, 4.566176367618685878e-12, 4.566176367618685878e-12, 1.551310987485935398e-02, 3.309758709792034345e-06, 4.333498812272349072e-03, 1.551310987485935398e-02, 1.903035094013049694e-21, 2.959075202307440677e-07, 4.225258439631110457e-10, 4.421164421898454711e-02, 3.226518598373974471e-05, 2.959075202307440677e-07, 1.430993028968333969e-01, 1.903035094013049694e-21, 4.225258439631110457e-10, 1.430993028968333969e-01, 3.226518598373974471e-05, 4.421164421898454711e-02, 2.349403664659752112e-04, 9.688245529284254809e-02, 1.768022258182954352e-03, 9.858275829964838720e-04, 3.309758709792034345e-06, 9.372082806552459178e-02, 1.768022258182954352e-03, 9.372082806552459178e-02, 1.476557104026862410e-01, 9.858275829964838720e-04, 4.333498812272349072e-03, 1.476557104026862410e-01, 2.349403664659752112e-04),
    (8.823151988713996391e-45, 2.332204174318528461e-27, 5.728650998340608745e-56, 1.165794765237651055e-02, 2.764556078556950881e-36, 4.072624717633741158e-48, 1.914714214218525338e-25, 5.881010699300556648e-67, 2.175702428714775840e-10, 6.610498069228468602e-39, 4.675973952563834421e-06, 7.912918315856256558e-61, 8.321030089138647840e-52, 2.349638855141306104e-02, 2.123779208924948428e-12, 1.169869203766870029e-13, 1.524177029773773434e-31, 3.318711099677051844e-08, 1.560543759860818455e-09, 2.179136932463778929e-29, 9.992242712355998473e-42, -2.555098045918444941e-04, -2.241690549232919737e-03, 6.054609539583663547e-02, 2.360855272927444972e-11, 8.108079306253045517e-04, 1.013359032410814206e-13, 7.750724758884266004e-34, 7.699205480918628382e-09, 1.399993373051156139e-04, 2.736249936842626933e-07, 2.157340473532454820e-05, 2.317853741494368004e-03, -6.868088867756604043e-03, 4.283096239652469652e-04, 3.958048330358010514e-02, 1.756589052393765114e-07, 1.187429460595669506e-02, 8.812581632544770710e-07, 4.072624717633741158e-48, 9.992242712355998473e-42, 7.912918315856256558e-61, 2.717875933335900016e-20, 6.610498069228468602e-39, 8.335951137105458603e-15, 1.322870363778446040e-18, 9.049907887097373427e-02, 2.175702428714775840e-10, 4.283096239652469652e-04, 6.351777619826335869e-22, 4.429742347393624813e-16, 1.914714214218525338e-25, 1.232134560467146984e-23, 2.764556078556950881e-36, 3.958048330358010514e-02, 8.823151988713996391e-45, 2.717875933335900016e-20, 1.169869203766870029e-13, 2.317853741494368004e-03, 4.675973952563834421e-06, -2.510946060860437534e-02, 2.157340473532454820e-05, 3.318711099677051844e-08, -1.603802571689216247e-17, 8.321030089138647840e-52, 1.524177029773773434e-31, -1.603802571689216247e-17, 2.179136932463778929e-29, 7.750724758884266004e-34, 1.322870363778446040e-18, 5.881010699300556648e-67, -2.241690549232919737e-03, -2.510946060860437534e-02, 1.399993373051156139e-04, -6.868088867756604043e-03, 3.262744522103358460e-17, -2.555098045918444941e-04, 2.332204174318528461e-27, 1.756589052393765114e-07, 8.812581632544770710e-07, 2.360855272927444972e-11, 1.013359032410814206e-13, 8.335951137105458603e-15, 5.728650998340608745e-56, 1.187429460595669506e-02, 2.349638855141306104e-02, 1.560543759860818455e-09, 1.166672226897644410e-01, 9.049907887097373427e-02, 7.699205480918628382e-09, 6.351777619826335869e-22, 2.736249936842626933e-07, 2.123779208924948428e-12, 1.161449102169717779e-01, 4.429742347393624813e-16, 3.262744522103358460e-17, 8.108079306253045517e-04, 1.232134560467146984e-23, 1.161449102169717779e-01, 1.166672226897644410e-01, 1.165794765237651055e-02, 1.205674705975654931e-01, 6.054609539583663547e-02)
)

const grad_free_hermite_nodes_asym = (
    ( 0.0,),
    ( 0.0, 1.732050807568877193e+00),
    ( -2.861279576057058183e+00, 2.861279576057058183e+00, -1.732050807568877193e+00, 7.410953499945408529e-01, 1.732050807568877193e+00, -4.184956017672732287e+00, 4.184956017672732287e+00, -7.410953499945408529e-01, 0.0),
    ( 0.0, 1.732050807568877193e+00, 7.410953499945408529e-01, 2.861279576057058183e+00, 4.184956017672732287e+00),
    (
        0.000000000000000000e+00,
        1.732050807568877193e+00,
        7.410953499945408529e-01,
        1.230423634027306035e+00,


        2.596083115049202306e+00,

        2.861279576057058183e+00,

        3.205333794499194422e+00,
        4.184956017672732287e+00,
        5.187016039913656229e+00,
        6.363394494336369611e+00
    )
)

const grad_free_hermite_weights_asym = (
    ( 1.0, ),
    ( 6.666666666666666297e-01, 1.666666666666666574e-01 ),
    ( 2.539682539682539542e-01, 9.485094850948509737e-02, 2.700743295779378661e-01, 7.996325470893532808e-03, 9.426945755651748365e-05),
    
    (
        3.034671998542058935e-01, 
        6.409605468680758256e-02,
        2.083249916496088816e-01,
        6.115173012524767471e-02,


        1.808523425479845181e-02,

        -6.337224793373735440e-03,

        2.884880436506751140e-03,
        6.012336945984782032e-05,
        6.094808731468982961e-07,
        8.629684602229885931e-10)
)

const rules_list = (1,2,6,10,18,66)
const path = "/home/chris/Documents/progwork/julia/hermite/rules_nw"

function print_rules(rule)
    file = path * "/rule_"
    for i ∈ 1:rule
        file *= string(rules_list[i]) * "_"
    end
    file *= "qr_0.csv"
    data_string = readdlm( file, ',', String)
    data_floats = readdlm( file, ',')

end




function inds(i::I, j::I, m::NTuple{N,I}, mcourse::NTuple{N,I}) where {N,I<:Integer}
    distbase = mcourse[i]
    distcurrent =  j-1 + mcourse[i]
    distcurrent, cld(hermite_weights[distcurrent],2) + m[i] - cld(length(hermite_weights[distbase]),2)
end

@generated function calc_weights(::Val{L}, m::NTuple{N,I}, mcourse::NTuple{N,I}) where {L,N,I<:Integer}
    weight_expr = weights(Val{N}(), L)
    Lp1 = L+1
    quote
        @nexprs $N i -> begin
            @nexprs $Lp1 j -> begin
                i1, i2 = inds(i, j, m, mcourse)
                $(Symbol(     '`' + i, :_, j-1 )) = $hermite_weights[ i1 ][ 2i2-1 ]
                $(Symbol(:d,  '`' + i, :_, j-1 )) = $hermite_weights[ i1 ][ 2i2   ]
            end
        end

        $weight_expr
    end
end